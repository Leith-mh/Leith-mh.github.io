<!doctype html><!-- This site was created with Wowchemy. https://www.wowchemy.com --><!-- Last Published: October 15, 2022 --><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=B612+Mono&family=B612:wght@400;700&family=Jura:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=B612+Mono&family=B612:wght@400;700&family=Jura:wght@400;700&display=swap" media=print onload='this.media="all"'><script src=/js/mathjax-config.js></script>
<link rel=stylesheet href=/css/vendor-bundle.min.16f785cdb553c8c4431db6775122af35.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin=anonymous media=print onload='this.media="all"'><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script>
<link rel=stylesheet href=/css/wowchemy.d25b5e9b635b455c98456235ef621092.css><link rel=stylesheet href=/css/libs/chroma/github-light.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=author content="Leith Mahfoudhi"><meta name=description content="High level overview of Active Directory Active Directory or AD is a windows-based directory service. It allows for centralized management of the authentication and authorization. It enables administrators to deploy role-based access control and least privilege efficiently."><link rel=alternate hreflang=en-us href=https://leith-mh.github.io/post/writing-technical-content/><link rel=canonical href=https://leith-mh.github.io/post/writing-technical-content/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1565c0"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wowchemy"><meta property="twitter:creator" content="@wowchemy"><meta property="twitter:image" content="https://leith-mh.github.io/post/writing-technical-content/featured.jpg"><meta property="og:site_name" content="Leith"><meta property="og:url" content="https://leith-mh.github.io/post/writing-technical-content/"><meta property="og:title" content="Attacking Active Directory serie -Part I | Leith"><meta property="og:description" content="High level overview of Active Directory Active Directory or AD is a windows-based directory service. It allows for centralized management of the authentication and authorization. It enables administrators to deploy role-based access control and least privilege efficiently."><meta property="og:image" content="https://leith-mh.github.io/post/writing-technical-content/featured.jpg"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2019-07-12T00:00:00+00:00"><meta property="article:modified_time" content="2019-07-12T00:00:00+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://leith-mh.github.io/post/writing-technical-content/"},"headline":"Attacking Active Directory serie -Part I","image":["https://leith-mh.github.io/post/writing-technical-content/featured.jpg"],"datePublished":"2019-07-12T00:00:00Z","dateModified":"2019-07-12T00:00:00Z","author":{"@type":"Person","name":"Leith Mahfoudhi"},"publisher":{"@type":"Organization","name":"Leith","logo":{"@type":"ImageObject","url":"https://leith-mh.github.io/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_3.png"}},"description":"High level overview of Active Directory Active Directory or AD is a windows-based directory service. It allows for centralized management of the authentication and authorization. It enables administrators to deploy role-based access control and least privilege efficiently."}</script><title>Attacking Active Directory serie -Part I | Leith</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=07e02bccc368a192a0c76c44918396c3><script src=/js/wowchemy-init.min.eb494022c3035bcfc7233efd58d079d7.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Leith</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Leith</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#posts><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/#projects><span>Projects</span></a></li><li class=nav-item><a class=nav-link href=/#contact><span>Contact</span></a></li><li class=nav-item><a class=nav-link href=/uploads/leith.pdf><span>CV</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>Attacking Active Directory serie -Part I</h1><p class=page-subtitle>What is active Directory?</p><div class=article-metadata><span class=article-date>Jul 12, 2019</span>
<span class=middot-divider></span>
<span class=article-reading-time>3 min read</span></div></div><div class="article-header container featured-image-wrapper mt-4 mb-4" style=max-width:809px;max-height:550px><div style=position:relative><img src=/post/writing-technical-content/featured_hu3b6ae6999a91afcff167cc2154303827_234659_1200x2500_fit_q75_h2_lanczos.webp width=809 height=550 alt class=featured-image></div></div><div class=article-container><div class=article-style><h1 id=high-level-overview-of-active-directory><strong>High level overview of Active Directory</strong></h1><p>Active Directory or AD is a windows-based directory service. It allows for centralized management of the authentication and authorization. It enables administrators to deploy role-based access control and least privilege efficiently. It stores information related to objects such as Computers,Users,Printers.Physically Active Directory is a collection of machines and servers connected inside of domains, that are a collective part of a bigger forest of domains, that make up the Active Directory network.</p><p><em><strong>But why using active Directory</strong></em></p><p>The majority of large companies use Active Directory because it allows for the control and monitoring of their user&rsquo;s computers through a single domain controller. It allows a single user to sign in to any computer on the active directory network and have access to his or her stored files and folders in the server, as well as the local storage on that machine. This allows for any user in the company to use any machine that the company owns, without having to set up multiple users on a machine. Active Directory does it all for you</p><h2 id=physical-active-directory-components><strong>Physical Active Directory Components</strong></h2><p>The physical Active Directory is the servers and machines on-premise or in the Cloud</p><h3 id=domain-controllers>Domain Controllers</h3><ul><li>A server with the AD DS server role installed and that has been promoted to a domain controller</li><li>Host a copy of the AD DS directory store</li><li>Provide authentication and authorization services</li><li>Replicate updates to other domain controllers in the domain and forest</li><li>Allow administrative access to manage user accounts and network resources</li></ul><h3 id=ad-ds-data-store>AD DS Data Store</h3><ul><li>Contains the database files and process that store and mange directory information for users,services and application</li><li>Consists of the Ntds.dit file</li><li>stored by defualt in the %SystemRoot%\NTDS folder on all domain controllers</li><li>Only accessible through the domain controller process and protocols</li></ul><h2 id=logical-active-directory-components>Logical Active Directory Components</h2><h3 id=domains>Domains</h3><ul><li>Manage and group objects in an organization</li><li>An administrative boundary for applying policies to groups of objects</li><li>A replication boundary for replicating data between domain controllers</li><li>An authentication and authorization boundary that provides a way to limit the scope of access to resources</li></ul><h3 id=trees>Trees</h3><ul><li>A hierarchy of domains</li><li>create a two-way transitive trust with other domains</li><li>share a contiguous namespace with the parents domain</li></ul><h3 id=forests>Forests</h3><ul><li>A collection of domain trees</li><li>Share a common schema</li><li>Share a common configuration partition</li><li>Share the Enterprise Admins and Schema Admins groups</li></ul><h3 id=organization-units>Organization Units</h3><ul><li>AD containers that can contain users,groups,computers, etc&mldr;</li><li>Represent the organization hierarchically and logically</li><li>Manage a collection of objects in a consistent way</li><li>Apply policies</li></ul><h3 id=trust>Trust</h3><ul><li>Provide a mechanism for users to gain access to resources in another domain</li><li>All domains in a forest trust all other domains in the forest (can extend outside of the forest)</li></ul><p>There are two types of trusts that determine how the domains communicate.</p><ul><li>Directional - The direction of the trust flows from a trusting domain to a trusted domain</li><li>Transitive - The trust relationship expands beyond just two domains to include other trusted domains</li></ul><h3 id=domain-policies>Domain Policies</h3><ul><li>dictate how the server operates and what rules it will and will not follow</li><li>The policies apply to a domain as a whole</li></ul><h3 id=ad-ds-schema>AD DS Schema</h3><ul><li>Defines every type of object that can be stores in the directory</li><li>Enforces rules regarded Object creation and configuration</li></ul><h2 id=active-directory-domain-authentication>Active Directory Domain Authentication</h2><ul><li>LDAP - Lightweight Directory Access Protocol; provides communication between applications and directory services</li><li>Certificate Services - allows the domain controller to create, validate, and revoke public key certificates</li><li>DNS, LLMNR, NBT-NS - Domain Name Services for identifying IP hostnames</li></ul><h2 id=active-directory-domain-authentication-1>Active Directory Domain Authentication</h2><p>There are two main types of authentication in place for Active Directory: NTLM and Kerberos.</p><ul><li>Kerberos - The default authentication service for Active Directory uses ticket-granting tickets and service tickets to authenticate users and give users access to other resources across the domain.</li><li>NTLM - default Windows authentication protocol uses an encrypted challenge/response protocol</li></ul></div><div class=share-box><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fleith-mh.github.io%2Fpost%2Fwriting-technical-content%2F&text=Attacking+Active+Directory+serie+-Part+I" target=_blank rel=noopener class=share-btn-twitter aria-label=twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fleith-mh.github.io%2Fpost%2Fwriting-technical-content%2F&t=Attacking+Active+Directory+serie+-Part+I" target=_blank rel=noopener class=share-btn-facebook aria-label=facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=Attacking%20Active%20Directory%20serie%20-Part%20I&body=https%3A%2F%2Fleith-mh.github.io%2Fpost%2Fwriting-technical-content%2F" target=_blank rel=noopener class=share-btn-email aria-label=envelope><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fleith-mh.github.io%2Fpost%2Fwriting-technical-content%2F&title=Attacking+Active+Directory+serie+-Part+I" target=_blank rel=noopener class=share-btn-linkedin aria-label=linkedin-in><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=Attacking+Active+Directory+serie+-Part+I%20https%3A%2F%2Fleith-mh.github.io%2Fpost%2Fwriting-technical-content%2F" target=_blank rel=noopener class=share-btn-whatsapp aria-label=whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Fleith-mh.github.io%2Fpost%2Fwriting-technical-content%2F&title=Attacking+Active+Directory+serie+-Part+I" target=_blank rel=noopener class=share-btn-weibo aria-label=weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><div class=media-body><h5 class=card-title><a href=https://leith-mh.github.io/>Leith Mahfoudhi</a></h5><h6 class=card-subtitle>Devops & cybersecurity Enthusiast</h6><ul class=network-icon aria-hidden=true><li><a href=/#contact><i class="fas fa-envelope"></i></a></li><li><a href=https://github.com/Leith-mh target=_blank rel=noopener><i class="fab fa-github"></i></a></li><li><a href=https://www.linkedin.com/in/leith-mahfoudhi/ target=_blank rel=noopener><i class="fab fa-linkedin"></i></a></li></ul></div></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class="powered-by copyright-license-text">© 2022 Leith Mahfoudhi. This work is licensed under <a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank>CC BY NC ND 4.0</a></p><p class="powered-by footer-license-icons"><a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank aria-label="Creative Commons"><i class="fab fa-creative-commons fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-by fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nc fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nd fa-2x" aria-hidden=true></i></a></p><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script>
<script src=/en/js/wowchemy.min.e8ee06ba8371980ffde659871dd593b0.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js type=module></script></body></html>